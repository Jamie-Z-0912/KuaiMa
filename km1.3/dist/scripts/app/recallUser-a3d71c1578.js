define("app/recallUser",["../mod/base","../plugs/confirmTip.js"],function(require,exports,module){var t=require("../mod/base"),e=require("../plugs/confirmTip.js");$("#receiveAward").on("click",function(){var n=$(this);n.hasClass("gray")||t.custom({url:"api/v1/recall/receiveReward"},function(t){1e3!=t.status?(Tools.alertDialog({title:"领取失败",text:t.desc}),n.addClass("gray").text("召回用户专享")):new e({title:"领取成功",text:'<p style="padding:0 .15rem;">恭喜您获得3天加速卡，明日生效，先去任务大厅看看更多新玩法吧！</p>',sureTxt:"查看奖励",cancelTxt:"去任务大厅"},function(t){t?/browser.kuaima/.test(location.hostname)?window.location="http://browser.kuaima.cn/myCard.html?auth_token="+Tools.auth_token():window.location="http://t.kuaima.cn/browser/myCard.html?auth_token="+Tools.auth_token():/browser.kuaima/.test(location.hostname)?window.location="http://browser.kuaima.cn/taskCenter.html?auth_token="+Tools.auth_token():window.location="http://t.kuaima.cn/browser/taskCenter.html?auth_token="+Tools.auth_token()})})}),$("#toTaskCenter").on("click",function(){/browser.kuaima/.test(location.hostname)?window.location="http://browser.kuaima.cn/taskCenter.html?auth_token="+Tools.auth_token():window.location="http://t.kuaima.cn/browser/taskCenter.html?auth_token="+Tools.auth_token()}),$("#hotSearch").on("click",function(){window.location="kmb://hotsearch"}),$("#readMesA").on("click",function(){Tools.alertDialog({text:"阅读每日推送文章<br>可获得额外金币奖励"})}),$("#welfare").on("click",function(){var e=$(this);$("#welfare .over").length>0?window.location="http://activity.yuyiya.com/activity/index?id=1919&slotId=2953&login=normal&appKey=2cMgpedEXq4tgEy5Y6f4g963ZTkr&tenter=SOW":t.custom({url:"api/v1/task/receiveReward",data:{eventType:"join_fuli_act"}},function(t){1e3!=t.status?(1005==t.status&&$("#welfare .right").text("已完成").addClass("over"),Tools.alertDialog({text:t.desc,time:1e3},function(){window.location="http://activity.yuyiya.com/activity/index?id=1919&slotId=2953&login=normal&appKey=2cMgpedEXq4tgEy5Y6f4g963ZTkr&tenter=SOW"})):(Tools.alertDialog({text:"获得"+e.data("num")+"金币"}),setTimeout(function(){$("#welfare .right").text("已完成").addClass("over"),window.location="http://activity.yuyiya.com/activity/index?id=1919&slotId=2953&login=normal&appKey=2cMgpedEXq4tgEy5Y6f4g963ZTkr&tenter=SOW"},800))})}),$("#gatherA").on("click",function(){window.location="kmb://worthreadingtab"})}),define("mod/base",["zepto","../plugs/doT.min","./tools"],function(require,exports,module){function t(t,e){var n=t,o={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in o)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?o[a]:("00"+o[a]).substr((""+o[a]).length)));return e}function e(t){var e,n=function(){};if(!t.status)return void Tools.alertDialog({title:"出错了",text:"没有返回status"});if(/1001|1002|1003|1004|1008|1009|1013|1015/.test(t.status))e={title:"提醒",text:t.desc};else if(/1006|1007/.test(t.status)){var o=5;e={title:"提醒",text:"访问太过频繁，<span id='closeTimer'>"+o+"</span>s后自动刷新"};var a=setInterval(function(){o--,o<1&&(clearInterval(a),window.location.reload()),$("#closeTimer").text(o)},1e3)}else{if(1101!=t.status)return e=null,!0;e={title:"提醒",text:"请打开设置->通用->日期与时间校准您的系统时间"}}return null!=e?(Tools.alertDialog(e,n),!1):void 0}var $=require("zepto");var n=require("../plugs/doT.min"),o={key:"26817749",km_api:server+"km_task/"};require("./tools"),module.exports={formatDate:function(e,n){var o=n||"yyyy-MM-dd hh:mm";if(isNaN(e)||null==e)return e;if("object"==typeof e){var a=dd.getFullYear(),i=dd.getMonth()+1,r=dd.getDate();i<10&&(i="0"+i);var s=a+"-"+i+"-"+r,l=s.match(/(\d+)/g),c=new Date(l[0],l[1]-1,l[2]);return t(c,o)}var c=new Date(parseInt(e));return t(c,o)},baseAjax:function(t,n){var a={name:"app_key",value:o.key};t.showLoading&&(0==$(".ui-loading-block").length?$("body").append('<div class="ui-loading-block km-dialog show"><div class="ui-loading-cnt"><i class="ui-loading-bright"></i><p>加载中……</p></div></div>'):$(".ui-loading-block").addClass("show"),"paging"==t.logtype&&0!=t.data.skip||$(t.renderEle).hide()),t.data||(t.data={}),$.isFunction(t.data.push)?t.data.push(a):t.data.app_key=o.key,$.isFunction(t.data.push)?t.data.push({name:"auth_token",value:Tools.auth_token()}):t.data.auth_token=Tools.auth_token(),$.ajax({url:o.km_api+t.url,data:t.data,type:"GET",dataType:"jsonp",xhrFields:{withCredentials:!0},jsonpCallback:"jsonp"+Math.ceil(1e3*Math.random()),success:function(o){t.showLoading&&($(".ui-loading-block").removeClass("show"),"paging"==t.logtype&&0!=t.data.skip||$(t.renderEle).show()),e(o)&&n(o)},error:function(e,n,o){console.log(e),t.showLoading&&$(".ui-loading-block").removeClass("show"),"paging"!=t.logtype&&$(t.renderEle).show()}})},render:function(t,e,o,a,i){if($(e).length>0&&o){var r=a||void 0,s=$(e).text(),l=n.template(s,void 0,r);i?$(t).html(l(o)):$(t).append(l(o))}},custom:function(t,e){var n=this;t=t||{},t.logtype="custom",n.baseAjax(t,e)}}}),define("plugs/doT.min",[],function(require,exports,module){function t(e,n,o){return("string"==typeof n?n:n.toString()).replace(e.define||r,function(t,n,a,i){return 0===n.indexOf("def.")&&(n=n.substring(4)),n in o||(":"===a?(e.defineParams&&i.replace(e.defineParams,function(t,e,a){o[n]={arg:e,text:a}}),n in o||(o[n]=i)):new Function("def","def['"+n+"']="+i)(o)),""}).replace(e.use||r,function(n,a){e.useParams&&(a=a.replace(e.useParams,function(t,e,n,a){if(o[n]&&o[n].arg&&a)return t=(n+":"+a).replace(/'|\\/g,"_"),o.__exp=o.__exp||{},o.__exp[t]=o[n].text.replace(new RegExp("(^|[^\\w$])"+o[n].arg+"([^\\w$])","g"),"$1"+a+"$2"),e+"def.__exp['"+t+"']"}));var i=new Function("def","return "+a)(o);return i?t(e,i,o):i})}function e(t){return t.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var n,o={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0};o.encodeHTMLSource=function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(n,function(t){return e[t]||t}):""}},n=function(){return this||(0,eval)("this")}(),void 0!==module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):n.doT=o;var a={start:"'+(",end:")+'",startencode:"'+encodeHTML("},i={start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("},r=/$^/;o.template=function(s,l,c){l=l||o.templateSettings;var u,d,p=l.append?a:i,g=0;s=l.use||l.define?t(l,s,c||{}):s,s=("var out='"+(l.strip?s.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):s).replace(/'|\\/g,"\\$&").replace(l.interpolate||r,function(t,n){return p.start+e(n)+p.end}).replace(l.encode||r,function(t,n){return u=!0,p.startencode+e(n)+p.end}).replace(l.conditional||r,function(t,n,o){return n?o?"';}else if("+e(o)+"){out+='":"';}else{out+='":o?"';if("+e(o)+"){out+='":"';}out+='"}).replace(l.iterate||r,function(t,n,o,a){return n?(g+=1,d=a||"i"+g,n=e(n),"';var arr"+g+"="+n+";if(arr"+g+"){var "+o+","+d+"=-1,l"+g+"=arr"+g+".length-1;while("+d+"<l"+g+"){"+o+"=arr"+g+"["+d+"+=1];out+='"):"';} } out+='"}).replace(l.evaluate||r,function(t,n){return"';"+e(n)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),u&&(l.selfcontained||!n||n._encodeHTML||(n._encodeHTML=o.encodeHTMLSource(l.doNotSkipEncoded)),s="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+o.encodeHTMLSource.toString()+"("+(l.doNotSkipEncoded||"")+"));"+s);try{return new Function(l.varname,s)}catch(t){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+s),t}},o.compile=function(t,e){return o.template(t,null,e)},module.exports=o}),define("mod/tools",[],function(require){var t={getQueryValue:function(t){var e=location.search,n=new Array;if(e.length>1){var o=e.indexOf("?");e=e.substring(o+1,e.length)}else e=null;if(e)for(var a=0;a<e.split("&").length;a++)n[a]=e.split("&")[a];for(var i=0;i<n.length;i++)if(n[i].split("=")[0]==t)return decodeURI(n[i].split("=")[1]);return""},uid:function(){return this.getQueryValue("uid")||"null"},auth_token:function(){return this.getQueryValue("auth_token")||"null"},alertDialog:function(t,e){var n={title:null,text:null,img:null,time:3e3};for(var o in n)t[o]=t[o]||n[o];var a="tips"+(new Date).getTime(),i='<div id="'+a+'" class="ui-popup-screen km-dialog"><div class="ui-overlay-shadow km-popup">';t.time<1&&(i+='<i class="iconfont icon-close" id="close"></i>'),i+='<div class="content">',null!=t.title&&""!=t.title&&(i+="<h1>"+t.title+"</h1>"),null!=t.text&&""!=t.text&&(i+="<p>"+t.text+"</p>"),null!=t.img&&""!=t.img&&(i+='<div class="pic"><img src="'+t.img+'"/></div>'),i+="</div> </div> </div>";var r=$(i).appendTo("body"),s=$("#"+a+" .km-popup").height(),l=$(window).height(),c=(l-s)/2;if($("#"+a+" .km-popup").css("top",c),r.addClass("show-dialog"),$("#close").click(function(){$("#"+a).remove(),$.isFunction(e)&&e()}),t.time>0){var u=t.time;setTimeout(function(){$("#"+a).remove(),$.isFunction(e)&&e()},u)}}};window.Tools=t}),define("plugs/confirmTip",[],function(require,exports,module){var t=function(t,e){var n={title:"",text:"",sureTxt:"确定",cancelTxt:"取消"};this.option={};for(var o in n)this.option[o]=t[o]||n[o];this.id="pop_"+(new Date).getTime(),this.init(e)};t.prototype.init=function(t){var e=this,n=e.option,o=[],a=e.id;o.push('<div class="pop-mask km-dialog"></div>'),o.push('<div class="pop-screen km-dialog" id="'+a+'">'),o.push('<div class="box">'),""!=n.title&&o.push("<h2>"+n.title+"</h2>"),""!=n.text&&o.push('<div class="text">'+n.text+"</div>"),o.push('<div class="btnbox"><a class="cancelBtn">'+n.cancelTxt+'</a><a class="sureBtn">'+n.sureTxt+"</a></div>"),o.push("</div></div>"),$("body").append(o.join("")),$("#"+a).height($("#"+a+" .box").height()),$("#"+a+" .sureBtn").click(function(){$("#"+a).prev().remove(),$("#"+a).remove(),$.isFunction(t)&&t(!0)}),$("#"+a+" .cancelBtn").click(function(){$("#"+a).prev().remove(),$("#"+a).remove(),$.isFunction(t)&&t(!1)})},module.exports=t});