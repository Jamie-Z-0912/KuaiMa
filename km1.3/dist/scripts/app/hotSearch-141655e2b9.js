define("app/hotSearch",["../mod/base","../plugs/version"],function(require,exports,module){function e(e){var t=[];t.push('<div class="ui-popup-screen km-dialog">'),t.push('<div class="hot-tips">'),t.push('<div class="text">点选搜索结果，阅读一段时间<span>才算完成任务</span></div>'),t.push('<img src="image/hotSearch_tip.png" />'),t.push('<a href="kmb://search?keyword='+encodeURIComponent(e)+'" class="btn">去点击</a>'),t.push("</div></div>"),$("body").append(t.join(""))}var t=require("../mod/base"),n=require("../plugs/version");t.custom({url:"api/v1/search/task"},function(e){var n=e.data,a=n.todaySearchKeywordNum,o=[];$.each(n.isReceiveRewardFlags,function(e,t){var n={};n.key=e,n.isover=t,n.cur_num=a,n.width=a>e?"100%":a/e*100+"%",n.coin=80+2*(e-10),n.isok=a>e-1&&!t,o.push(n)}),t.render("#schedule","#schedule-tmpl",o,void 0,!0);for(var r=[],i=0;i<n.searchHotKeywords.length;i++)r.push('<div class="keyword">'+n.searchHotKeywords[i]+"</div>");$("#keywords").html(r.join(""))}),n.less("1.3.2")?($("#upgradeTip").removeClass("hide"),Tools.alertDialog({text:"本活动仅在1.3.2版本才有效<br/>快快更新升级吧~",time:"9999999"})):$("#upgradeTip").remove(),$("#keywords").on("click",".keyword",function(){e($(this).text())}),$("#schedule").on("click",".btn",function(){var e=$(this);if(e.hasClass("ok")){var n=e.data("goal");t.custom({url:"api/v1/searchReward/receive",data:{searchKeywordNum:n}},function(t){switch(t.status){case 1e3:Tools.alertDialog({text:"奖励领取成功"}),e.removeClass("ok").text("已经领取");break;case 9400:Tools.alertDialog({text:"搜索任务奖励已领取"}),e.removeClass("ok").text("已经领取");break;case 9401:Tools.alertDialog({text:"您还未达到搜索次数"});break;case 1007:Tools.alertDialog({text:"服务器异常，请退出稍后再试"})}})}})}),define("mod/base",["zepto","../plugs/doT.min","./tools"],function(require,exports,module){function e(e,t){var n=e,a={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var o in a)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[o]:("00"+a[o]).substr((""+a[o]).length)));return t}function t(e){var t,n=function(){};if(!e.status)return void Tools.alertDialog({title:"提醒",text:"系统错误，请稍后重试！"});switch(e.status){case 1101:t={title:"提醒",text:"请打开设置->通用->日期与时间校准您的系统时间"};break;case 1004:t={title:"提醒",text:"请在快马小报中登录再访问！"};break;case 1002:t={title:"提醒",text:"请在快马小报中访问！"};break;case 1006:var a=5;t={title:"提醒",text:"访问太过频繁，<span id='closeTimer'>"+a+"</span>s后自动刷新"};var o=setInterval(function(){a--,a<1&&(clearInterval(o),window.location.reload()),$("#closeTimer").text(a)},1e3);break;default:return t=null,!0}return null!=t?(Tools.alertDialog(t,n),!1):void 0}var $=require("zepto");var n=require("../plugs/doT.min"),a={key:"26817749",km_api:server+"km_task/"};require("./tools"),module.exports={formatDate:function(t,n){var a=n||"yyyy-MM-dd hh:mm";if(isNaN(t)||null==t)return t;if("object"==typeof t){var o=dd.getFullYear(),r=dd.getMonth()+1,i=dd.getDate();r<10&&(r="0"+r);var s=o+"-"+r+"-"+i,l=s.match(/(\d+)/g),u=new Date(l[0],l[1]-1,l[2]);return e(u,a)}var u=new Date(parseInt(t));return e(u,a)},baseAjax:function(e,n){var o={name:"app_key",value:a.key};e.showLoading&&(0==$(".ui-loading-block").length?$("body").append('<div class="ui-loading-block km-dialog show"><div class="ui-loading-cnt"><i class="ui-loading-bright"></i><p>加载中……</p></div></div>'):$(".ui-loading-block").addClass("show"),"paging"==e.logtype&&0!=e.data.skip||$(e.renderEle).hide()),e.data||(e.data={}),$.isFunction(e.data.push)?e.data.push(o):e.data.app_key=a.key,$.isFunction(e.data.push)?e.data.push({name:"auth_token",value:Tools.auth_token()}):e.data.auth_token=Tools.auth_token(),$.ajax({url:a.km_api+e.url,data:e.data,type:"GET",dataType:"jsonp",xhrFields:{withCredentials:!0},jsonpCallback:"jsonp"+Math.ceil(1e3*Math.random()),success:function(a){e.showLoading&&($(".ui-loading-block").removeClass("show"),"paging"==e.logtype&&0!=e.data.skip||$(e.renderEle).show()),t(a)&&n(a)},error:function(t,n,a){console.log(t),e.showLoading&&$(".ui-loading-block").removeClass("show"),"paging"!=e.logtype&&$(e.renderEle).show()}})},render:function(e,t,a,o,r){if($(t).length>0&&a){var i=o||void 0,s=$(t).text(),l=n.template(s,void 0,i);r?$(e).html(l(a)):$(e).append(l(a))}},custom:function(e,t){var n=this;e=e||{},e.logtype="custom",n.baseAjax(e,t)}}}),define("plugs/doT.min",[],function(require,exports,module){function e(t,n,a){return("string"==typeof n?n:n.toString()).replace(t.define||i,function(e,n,o,r){return 0===n.indexOf("def.")&&(n=n.substring(4)),n in a||(":"===o?(t.defineParams&&r.replace(t.defineParams,function(e,t,o){a[n]={arg:t,text:o}}),n in a||(a[n]=r)):new Function("def","def['"+n+"']="+r)(a)),""}).replace(t.use||i,function(n,o){t.useParams&&(o=o.replace(t.useParams,function(e,t,n,o){if(a[n]&&a[n].arg&&o)return e=(n+":"+o).replace(/'|\\/g,"_"),a.__exp=a.__exp||{},a.__exp[e]=a[n].text.replace(new RegExp("(^|[^\\w$])"+a[n].arg+"([^\\w$])","g"),"$1"+o+"$2"),t+"def.__exp['"+e+"']"}));var r=new Function("def","return "+o)(a);return r?e(t,r,a):r})}function t(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var n,a={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0};a.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(n,function(e){return t[e]||e}):""}},n=function(){return this||(0,eval)("this")}(),void 0!==module&&module.exports?module.exports=a:"function"==typeof define&&define.amd?define(function(){return a}):n.doT=a;var o={start:"'+(",end:")+'",startencode:"'+encodeHTML("},r={start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("},i=/$^/;a.template=function(s,l,u){l=l||a.templateSettings;var c,d,p=l.append?o:r,g=0;s=l.use||l.define?e(l,s,u||{}):s,s=("var out='"+(l.strip?s.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):s).replace(/'|\\/g,"\\$&").replace(l.interpolate||i,function(e,n){return p.start+t(n)+p.end}).replace(l.encode||i,function(e,n){return c=!0,p.startencode+t(n)+p.end}).replace(l.conditional||i,function(e,n,a){return n?a?"';}else if("+t(a)+"){out+='":"';}else{out+='":a?"';if("+t(a)+"){out+='":"';}out+='"}).replace(l.iterate||i,function(e,n,a,o){return n?(g+=1,d=o||"i"+g,n=t(n),"';var arr"+g+"="+n+";if(arr"+g+"){var "+a+","+d+"=-1,l"+g+"=arr"+g+".length-1;while("+d+"<l"+g+"){"+a+"=arr"+g+"["+d+"+=1];out+='"):"';} } out+='"}).replace(l.evaluate||i,function(e,n){return"';"+t(n)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),c&&(l.selfcontained||!n||n._encodeHTML||(n._encodeHTML=a.encodeHTMLSource(l.doNotSkipEncoded)),s="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+a.encodeHTMLSource.toString()+"("+(l.doNotSkipEncoded||"")+"));"+s);try{return new Function(l.varname,s)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+s),e}},a.compile=function(e,t){return a.template(e,null,t)},module.exports=a}),define("mod/tools",[],function(require){var e={getQueryValue:function(e){var t=location.search,n=new Array;if(t.length>1){var a=t.indexOf("?");t=t.substring(a+1,t.length)}else t=null;if(t)for(var o=0;o<t.split("&").length;o++)n[o]=t.split("&")[o];for(var r=0;r<n.length;r++)if(n[r].split("=")[0]==e)return decodeURI(n[r].split("=")[1]);return""},uid:function(){return this.getQueryValue("uid")||"null"},auth_token:function(){return this.getQueryValue("auth_token")||"null"},alertDialog:function(e,t){var n={title:null,text:null,img:null,time:3e3};for(var a in n)e[a]=e[a]||n[a];var o="tips"+(new Date).getTime(),r='<div id="'+o+'" class="ui-popup-screen km-dialog"><div class="ui-overlay-shadow km-popup">';e.time<1&&(r+='<i class="iconfont icon-close" id="close"></i>'),r+='<div class="content">',null!=e.title&&""!=e.title&&(r+="<h1>"+e.title+"</h1>"),null!=e.text&&""!=e.text&&(r+="<p>"+e.text+"</p>"),null!=e.img&&""!=e.img&&(r+='<div class="pic"><img src="'+e.img+'"/></div>'),r+="</div> </div> </div>";var i=$(r).appendTo("body"),s=$("#"+o+" .km-popup").height(),l=$(window).height(),u=(l-s)/2;if($("#"+o+" .km-popup").css("top",u),i.addClass("show-dialog"),$("#close").click(function(){$("#"+o).remove(),$.isFunction(t)&&t()}),e.time>0){var c=e.time;setTimeout(function(){$("#"+o).remove(),$.isFunction(t)&&t()},c)}}};window.Tools=e}),define("plugs/version",[],function(require,exports,module){var e,t={},n=navigator.userAgent;if(t.isKM=/KuaiMa/.test(n),t.isKM){var a=n.split("ssy=")[1];e=/iOS|Android/.test(a.split(";")[0])?a.split(";")[2]:a.split(";")[1],t.version=e.replace("V","")}t.equal=function(e){return!!t.isKM&&e==this.version},t.greater=function(e){if(t.isKM){for(var n=this.version.split("."),a=e.split("."),o=!1,r=0;r<n.length&&!(n[r]<a[r]);r++)n[r]>a[r]&&(o=!0);return o}return!1},t.less=function(e){if(t.isKM){for(var n=this.version.split("."),a=e.split("."),o=!1,r=0;r<n.length&&!(n[r]>a[r]);r++)n[r]<a[r]&&(o=!0);return o}return!1},t.gEq=function(e){return!(!this.equal(e)&&!this.greater(e))},t.lEq=function(e){return!(!this.equal(e)&&!this.less(e))},module.exports=t});