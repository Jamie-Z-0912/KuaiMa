define("app/list",["../mod/base","../plugs/tipsAd.js"],function(require,exports,module){var e=require("../mod/base"),t=require("../plugs/tipsAd.js"),i=function(e,t,i){this.el=e,this.remaining=t/1e3,this.isFirst=!0,this.zeroize=function(e){return e<10?"0"+e:""+e},this.callback=i,this.init()};i.prototype.init=function(){var e,t,i,n=this;e=parseInt(n.remaining/3600),t=parseInt(n.remaining%3600/60),i=parseInt(n.remaining%3600%60),$(n.el).html('<em class="h">'+n.zeroize(e)+'</em>:<em class="m">'+n.zeroize(t)+'</em>:<em class="s">'+n.zeroize(i)+"</em>").show().prev().show(),n.count()},i.prototype.count=function(){var e,t,i,n,a,o,s=this;if(i=parseInt($(s.el+" .s").text()),t=parseInt($(s.el+" .m").text()),e=parseInt($(s.el+" .h").text()),n=i>0?i-1:0==t&&0==e?0:59,$(s.el+" .s").text(s.zeroize(n)),0==i&&(a=t>0?t-1:0==e?0:59,$(s.el+" .m").text(s.zeroize(a))),0==i&&0==t&&(o=e>0?e-1:0,$(s.el+" .h").text(s.zeroize(o))),0==n&&0==t&&0==e)return void($.isFunction(s.callback)&&s.callback());setTimeout(function(){s.count()},1e3)},e.custom({url:"api/v1/coin/queryActivity"},function(n){if(0!=n.data.countDown&&n.data.activity_status){$("#nav").removeClass("no_act").addClass("act");var a=e.formatDate(n.data.activity.begin_time,"yyyy-MM-dd"),o=e.formatDate(n.data.activity.ent_time,"yyyy-MM-dd");$("#periods").text(n.data.periods+"期");var s=n.data.activity.reward_desc;s=s.replace(/奖金/,"奖金<i>"),s=s.replace(/元/,"</i>元"),$("#rewardDesc").html(s),new i("#timer",n.data.countDown),$(".header-timer").show(),$("#rule").on("click",function(){new t({type:"",subtit:'<span style="line-height:1.5;"></span>活动时间：<br>'+a+"至"+o,text:'<p style="text-align: left;padding: 0 .2rem;"><i style="color:#fa3719">活动规则</i>：根据每日收益排名，今日榜单实时更新。每日前十名可获得相应额外奖励。奖励名单以当日最终榜单为准。<br><i style="color:#fa3719">奖励发放</i>：当日奖励会在次日凌晨结算期间自动发放到获奖账户。可在收入明细中查看奖励到账情况。</p>',hasAd:"0",isClose:"no",btnType:"1"})})}else $(".header-timer").remove()});var n=function(){e.custom({url:"api/v1/coin/rank/today"},function(t){if(1020==t.status)$("#today").html('<div class="empty" style="margin-top:-1.7rem;opacity:.7"><img src="image/empty_2.png"><p style="color:#000;">还没有排行结果</p></div>');else{var i={day:!0,rmbtmpl:""};t.data.activity_status&&($("#today").css("padding-top","2.2rem"),i.rmbtmpl=$("#rmbtmpl").text()),e.render("#todayList","#conList-tmpl",t.data,i,!0)}});var t=window.setTimeout(function(){window.clearTimeout(t),n()},5e4)};n(),e.custom({url:"api/v1/coin/rank/yesterday"},function(t){var i=(t.data.yes_date.substr(5),{day:null,rmbtmpl:""});t.data.activity_status&&($("#today").css("padding-top","2.2rem"),i.rmbtmpl=$("#rmbtmpl").text()),e.render("#yesterdayList","#conList-tmpl",t.data,i,!0)}),e.custom({url:"api/v1/coin/rank/all"},function(t){var i={day:null,rmbtmpl:""};e.render("#totalList","#conList-tmpl",t.data,i,!0)}),$("#nav").on("click","li",function(){var e=$(this),t=e.data("id");$(this).addClass("active").siblings().removeClass("active"),$("#"+t).show().siblings(".main-list").hide()})}),define("mod/base",["zepto","../plugs/doT.min","./tools"],function(require,exports,module){function e(e,t){var i=e,n={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in n)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[a]:("00"+n[a]).substr((""+n[a]).length)));return t}function t(e){var t,i=function(){};if(!e.status)return void Tools.alertDialog({title:"提醒",text:"系统错误，请稍后重试！"});switch(e.status){case 1101:t={title:"提醒",text:"请打开设置->通用->日期与时间校准您的系统时间"};break;case 1004:t={title:"提醒",text:"请在快马浏览器中登录再访问！"};break;case 1002:t={title:"提醒",text:"请在快马浏览器中访问！"};break;case 1006:var n=5;t={title:"提醒",text:"访问太过频繁，<span id='closeTimer'>"+n+"</span>s后自动刷新"};var a=setInterval(function(){n--,n<1&&(clearInterval(a),window.location.reload()),$("#closeTimer").text(n)},1e3);break;default:return t=null,!0}return null!=t?(Tools.alertDialog(t,i),!1):void 0}var $=require("zepto");var i=require("../plugs/doT.min"),n={key:"26817749",km_api:server+"km_task/"};require("./tools"),module.exports={formatDate:function(t,i){var n=i||"yyyy-MM-dd hh:mm";if(isNaN(t)||null==t)return t;if("object"==typeof t){var a=dd.getFullYear(),o=dd.getMonth()+1,s=dd.getDate();o<10&&(o="0"+o);var r=a+"-"+o+"-"+s,l=r.match(/(\d+)/g),d=new Date(l[0],l[1]-1,l[2]);return e(d,n)}var d=new Date(parseInt(t));return e(d,n)},baseAjax:function(e,i){var a={name:"app_key",value:n.key};e.showLoading&&(0==$(".ui-loading-block").length?$("body").append('<div class="ui-loading-block km-dialog show"><div class="ui-loading-cnt"><i class="ui-loading-bright"></i><p>加载中……</p></div></div>'):$(".ui-loading-block").addClass("show"),"paging"==e.logtype&&0!=e.data.skip||$(e.renderEle).hide()),e.data||(e.data={}),$.isFunction(e.data.push)?e.data.push(a):e.data.app_key=n.key,$.isFunction(e.data.push)?e.data.push({name:"auth_token",value:Tools.auth_token()}):e.data.auth_token=Tools.auth_token(),$.ajax({url:n.km_api+e.url,data:e.data,type:"GET",dataType:"jsonp",xhrFields:{withCredentials:!0},jsonpCallback:"jsonp"+Math.ceil(1e3*Math.random()),success:function(n){e.showLoading&&($(".ui-loading-block").removeClass("show"),"paging"==e.logtype&&0!=e.data.skip||$(e.renderEle).show()),t(n)&&i(n)},error:function(t,i,n){console.log(t),e.showLoading&&$(".ui-loading-block").removeClass("show"),"paging"!=e.logtype&&$(e.renderEle).show()}})},render:function(e,t,n,a,o){if($(t).length>0&&n){var s=a||void 0,r=$(t).text(),l=i.template(r,void 0,s);o?$(e).html(l(n)):$(e).append(l(n))}},custom:function(e,t){var i=this;e=e||{},e.logtype="custom",i.baseAjax(e,t)}}}),define("plugs/doT.min",[],function(require,exports,module){function e(t,i,n){return("string"==typeof i?i:i.toString()).replace(t.define||s,function(e,i,a,o){return 0===i.indexOf("def.")&&(i=i.substring(4)),i in n||(":"===a?(t.defineParams&&o.replace(t.defineParams,function(e,t,a){n[i]={arg:t,text:a}}),i in n||(n[i]=o)):new Function("def","def['"+i+"']="+o)(n)),""}).replace(t.use||s,function(i,a){t.useParams&&(a=a.replace(t.useParams,function(e,t,i,a){if(n[i]&&n[i].arg&&a)return e=(i+":"+a).replace(/'|\\/g,"_"),n.__exp=n.__exp||{},n.__exp[e]=n[i].text.replace(new RegExp("(^|[^\\w$])"+n[i].arg+"([^\\w$])","g"),"$1"+a+"$2"),t+"def.__exp['"+e+"']"}));var o=new Function("def","return "+a)(n);return o?e(t,o,n):o})}function t(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var i,n={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0};n.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(i,function(e){return t[e]||e}):""}},i=function(){return this||(0,eval)("this")}(),void 0!==module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):i.doT=n;var a={start:"'+(",end:")+'",startencode:"'+encodeHTML("},o={start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("},s=/$^/;n.template=function(r,l,d){l=l||n.templateSettings;var c,u,p=l.append?a:o,g=0;r=l.use||l.define?e(l,r,d||{}):r,r=("var out='"+(l.strip?r.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):r).replace(/'|\\/g,"\\$&").replace(l.interpolate||s,function(e,i){return p.start+t(i)+p.end}).replace(l.encode||s,function(e,i){return c=!0,p.startencode+t(i)+p.end}).replace(l.conditional||s,function(e,i,n){return i?n?"';}else if("+t(n)+"){out+='":"';}else{out+='":n?"';if("+t(n)+"){out+='":"';}out+='"}).replace(l.iterate||s,function(e,i,n,a){return i?(g+=1,u=a||"i"+g,i=t(i),"';var arr"+g+"="+i+";if(arr"+g+"){var "+n+","+u+"=-1,l"+g+"=arr"+g+".length-1;while("+u+"<l"+g+"){"+n+"=arr"+g+"["+u+"+=1];out+='"):"';} } out+='"}).replace(l.evaluate||s,function(e,i){return"';"+t(i)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),c&&(l.selfcontained||!i||i._encodeHTML||(i._encodeHTML=n.encodeHTMLSource(l.doNotSkipEncoded)),r="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+n.encodeHTMLSource.toString()+"("+(l.doNotSkipEncoded||"")+"));"+r);try{return new Function(l.varname,r)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+r),e}},n.compile=function(e,t){return n.template(e,null,t)},module.exports=n}),define("mod/tools",[],function(require){var e={getQueryValue:function(e){var t=location.search,i=new Array;if(t.length>1){var n=t.indexOf("?");t=t.substring(n+1,t.length)}else t=null;if(t)for(var a=0;a<t.split("&").length;a++)i[a]=t.split("&")[a];for(var o=0;o<i.length;o++)if(i[o].split("=")[0]==e)return decodeURI(i[o].split("=")[1]);return""},uid:function(){return this.getQueryValue("uid")||"null"},auth_token:function(){return this.getQueryValue("auth_token")||"null"},alertDialog:function(e,t){var i={title:null,text:null,img:null,time:3e3};for(var n in i)e[n]=e[n]||i[n];var a="tips"+(new Date).getTime(),o='<div id="'+a+'" class="ui-popup-screen km-dialog"><div class="ui-overlay-shadow km-popup">';e.time<1&&(o+='<i class="iconfont icon-close" id="close"></i>'),o+='<div class="content">',null!=e.title&&""!=e.title&&(o+="<h1>"+e.title+"</h1>"),null!=e.text&&""!=e.text&&(o+="<p>"+e.text+"</p>"),null!=e.img&&""!=e.img&&(o+='<div class="pic"><img src="'+e.img+'"/></div>'),o+="</div> </div> </div>";var s=$(o).appendTo("body"),r=$("#"+a+" .km-popup").height(),l=$(window).height(),d=(l-r)/2;if($("#"+a+" .km-popup").css("top",d),s.addClass("show-dialog"),$("#close").click(function(){$("#"+a).remove(),$.isFunction(t)&&t()}),e.time>0){var c=e.time;setTimeout(function(){$("#"+a).remove(),$.isFunction(t)&&t()},c)}}};window.Tools=e}),define("plugs/tipsAd",[],function(require,exports,module){var e=function(e){var t={isClose:"yes",type:"",title:"",subtit:"",text:"",btnType:"0",hasAd:"1",adImg:"image/ad.png",adLink:"school_invite_0.html"};this.option={};for(var i in t)this.option[i]=e[i]||t[i];this.id="pop_"+(new Date).getTime(),this.init()};e.prototype.init=function(e){var t=this,i=t.option,n=[];n.push('<div class="pop-mask km-dialog"></div>'),n.push('<div class="pop-screen km-dialog" id="'+t.id+'">'),n.push('<div class="box">'),"yes"==i.isClose&&n.push('<i class="iconfont icon-close"></i>'),n.push('<div class="hd-img '+i.type+'"></div>'),""!=i.title&&n.push("<h1>"+i.title+"</h1>"),""!=i.subtit&&n.push("<h3>"+i.subtit+"</h3>"),""!=i.text&&n.push('<div class="text">'+i.text+"</div>"),"1"==i.hasAd&&n.push('<div class="ad"><a href="'+i.adLink+'"><img src="'+i.adImg+'" /></a></div>'),"1"==i.btnType&&n.push('<div class="btnbox"><a class="close">我知道了</a></div>'),n.push("</div></div>"),$("body").append(n.join("")),$("#"+t.id).height($("#"+t.id+" .box").height()),$("#"+t.id+" .icon-close, #"+t.id+" .close").on("click",function(){t.close()})},e.prototype.close=function(){var e=$("#"+this.id);e.prev().remove(),e.remove()},module.exports=e});